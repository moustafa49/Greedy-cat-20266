<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ˜º Greedy Cat MAX</title>

<style>
body{
  background:#0f0f0f;
  color:#fff;
  font-family:Tahoma,Arial;
  direction:rtl;
  text-align:center;
}
h1{margin:10px 0}
.card{
  background:#1a1a1a;
  margin:10px auto;
  padding:12px;
  border-radius:14px;
  max-width:420px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px;
}
.item{
  font-size:28px;
  padding:10px;
  border-radius:12px;
  background:#222;
  cursor:pointer;
}
.hot{box-shadow:0 0 10px orange}
.bar span{
  font-size:26px;
  margin:3px;
  cursor:pointer;
}
.green{color:#4caf50}
.red{color:#ff5252}
button{
  padding:8px 14px;
  border-radius:10px;
  border:none;
  margin:4px;
  cursor:pointer;
}
.active{background:orange;color:#000}
</style>
</head>

<body>

<h1>Greedy Cat MAX ğŸ˜º</h1>

<div class="card">
  <div>ÙˆØ¶Ø¹ Ø§Ù„ØªÙˆÙ‚Ø¹</div>
  <button onclick="setMode('32')" id="m32">3 Ø®Ø¶Ø§Ø± + 2 Ù„Ø­ÙˆÙ…</button>
  <button onclick="setMode('31')" id="m31">3 Ø®Ø¶Ø§Ø± + 1 Ù„Ø­Ù…Ø©</button>
  <button onclick="setMode('21p')" id="m21p" class="active">2 Ø®Ø¶Ø§Ø± + 1 Ø²ÙŠØ§Ø¯Ø©</button>
</div>

<div class="card">
  <div class="grid" id="items"></div>
  <p>Ø¶ØºØ· = ØªØ³Ø¬ÙŠÙ„ | Ø¶ØºØ· Ù…Ø·ÙˆÙ‘Ù„ = ğŸ”¥ HOT</p>
</div>

<div class="card">
  <div>ğŸ“œ Ø¢Ø®Ø± 20 Ø¯ÙˆØ± (Ø§Ø¶ØºØ· Ù„Ù„Ø­Ø°Ù)</div>
  <div class="bar" id="bar"></div>
</div>

<div class="card">
  <div>ğŸ“Š Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„ØºØ§ÙŠØ¨Ø©</div>
  <div id="missing"></div>
</div>

<div class="card">
  <div>ğŸ”® Ø§Ù„ØªÙˆÙ‚Ø¹ Ø§Ù„Ø°ÙƒÙŠ</div>
  <div id="rec"></div>
</div>

<button onclick="reset()">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>

<script>
const veggies=["ğŸŒ¶ï¸","ğŸ…","ğŸŒ½","ğŸ¥•"];
const meats=["ğŸ—","ğŸ¦","ğŸŸ","ğŸ”"];
const items=[...veggies,...meats];

let history=[];
let hot={};
let mode="21p";

const itemsDiv=document.getElementById("items");
const barDiv=document.getElementById("bar");
const missDiv=document.getElementById("missing");
const recDiv=document.getElementById("rec");

items.forEach(i=>{
  const d=document.createElement("div");
  d.className="item";
  d.innerText=i;
  d.onclick=()=>add(i);
  d.oncontextmenu=(e)=>{e.preventDefault();toggleHot(i)};
  itemsDiv.appendChild(d);
});

function toggleHot(i){
  hot[i]=!hot[i];
  render();
}

function add(i){
  history.push(i);
  render();
}

function remove(idx){
  history.splice(idx,1);
  render();
}

function setMode(m){
  mode=m;
  ["m32","m31","m21p"].forEach(x=>document.getElementById(x).classList.remove("active"));
  if(m==="32")m32.classList.add("active");
  if(m==="31")m31.classList.add("active");
  if(m==="21p")m21p.classList.add("active");
  render();
}

function score(i){
  let miss=history.length-history.lastIndexOf(i)-1;
  let h=hot[i]?3:0;
  return miss+h;
}

function percent(i){
  let c=history.filter(x=>x===i).length;
  return history.length?((c/history.length)*100).toFixed(1):"0";
}

function render(){
  // BAR
  barDiv.innerHTML="";
  history.slice(-20).forEach((i,idx)=>{
    const s=document.createElement("span");
    s.innerText=i;
    s.onclick=()=>remove(history.length-20+idx);
    barDiv.appendChild(s);
  });

  // MISSING
  missDiv.innerHTML="";
  items.forEach(i=>{
    if(history.includes(i)){
      let g=history.length-history.lastIndexOf(i)-1;
      if(g>5) missDiv.innerHTML+=`${i} ØºØ§ÙŠØ¨ ${g} Ø¯ÙˆØ±<br>`;
    }
  });

  // RECOMMEND
  let picks=[];
  if(mode==="21p"){
    let v=veggies.map(i=>({i,s:score(i)})).sort((a,b)=>b.s-a.s).slice(0,2);
    let e=items.filter(i=>!v.find(x=>x.i===i))
      .map(i=>({i,s:score(i)})).sort((a,b)=>b.s-a.s)[0];
    picks=[...v,e];
  }else{
    let v=veggies.map(i=>({i,s:score(i)})).sort((a,b)=>b.s-a.s).slice(0,3);
    let m=meats.map(i=>({i,s:score(i)})).sort((a,b)=>b.s-a.s)
      .slice(0,mode==="32"?2:1);
    picks=[...v,...m];
  }

  recDiv.innerHTML="";
  picks.forEach(p=>{
    let c=veggies.includes(p.i)?"green":"red";
    recDiv.innerHTML+=`<span class="${c}">${p.i} ${percent(p.i)}%</span> `;
  });

  // HOT UI
  document.querySelectorAll(".item").forEach(d=>{
    d.classList.toggle("hot",hot[d.innerText]);
  });
}

function reset(){
  history=[];
  hot={};
  render();
}

render();
</script>

</body>
</html>
