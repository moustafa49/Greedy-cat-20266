<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ğŸ˜º Greedy Cat MAX â€“ Ultimate</title>
<style>
body{
  background:#0f0f0f;color:#fff;
  font-family:'Cairo',Tahoma,Arial;
  direction:rtl;text-align:center;margin:0
}
h1{margin:14px 0}
.card{
  background:#1a1a1a;
  margin:10px auto;
  padding:14px;
  border-radius:16px;
  max-width:420px;
  box-shadow:0 0 14px #000
}
.grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px
}
.btn{
  font-size:2em;
  padding:10px 0;
  border-radius:14px;
  cursor:pointer;
  background:#161616;
  border:2px solid #333;
  transition:.15s
}
.btn:active{transform:scale(.95)}
.hot{border-color:#ff9800;box-shadow:0 0 10px #ff980088}
.alert{color:#ffb300;font-weight:bold}
.safe{color:#4caf50;font-weight:bold}
.small{font-size:.9em;color:#aaa}
.top5 span{margin:0 4px}
.score{font-size:.8em;color:#9cff57}
</style>
</head>

<body>
<h1>ğŸ˜º Greedy Cat MAX</h1>

<div class="card" id="status"></div>

<div class="card">
  <div class="grid" id="buttons"></div>
  <div class="small">Ø§Ø¶ØºØ· Ø¶ØºØ·Ø© = ØªØ³Ø¬ÙŠÙ„ | Ø¶ØºØ·ØªÙŠÙ† = ØªØ«Ø¨ÙŠØª ğŸ”¥</div>
</div>

<div class="card">
  <div class="top5" id="top5"></div>
  <div class="small" id="reason"></div>
</div>

<div class="card">
  <button onclick="resetAll()">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„ ğŸ—‘ï¸</button>
</div>

<script>
const meats=["ğŸ”","ğŸŸ","ğŸ¦","ğŸ—"];
const vegs=["ğŸ¥•","ğŸŒ½","ğŸ…","ğŸŒ¶ï¸"];
const all=[...meats,...vegs];

let data=JSON.parse(localStorage.getItem("gc_max"))||{
  selected:[],
  hot:{}
};

function save(){
  localStorage.setItem("gc_max",JSON.stringify(data));
}

function add(item){
  if(data.selected.length>=100) data.selected.shift();
  data.selected.push(item);
  save(); render();
}

function toggleHot(item){
  data.hot[item]=!data.hot[item];
  save(); render();
}

function score(item){
  let total=data.selected.filter(x=>x===item).length;
  let last10=data.selected.slice(-10).filter(x=>x===item).length;
  let lastIdx=data.selected.lastIndexOf(item);
  let gap=lastIdx===-1?20:data.selected.length-lastIdx;
  return total*2 + last10*3 + (gap>12?4:0) + (data.hot[item]?6:0);
}

function render(){
  let scores=all.map(i=>[i,score(i)])
    .sort((a,b)=>b[1]-a[1]);

  let meatCount=data.selected.filter(x=>meats.includes(x)).length;
  let vegCount=data.selected.filter(x=>vegs.includes(x)).length;

  let danger = meatCount>vegCount*2 || vegCount>meatCount*2;

  document.getElementById("status").innerHTML=
    danger
    ? "ğŸš¨ <span class='alert'>ÙˆØ¶Ø¹ Ø®Ø·Ø± â€“ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨ØªÙ„Ù</span>"
    : "âœ… <span class='safe'>Ø§Ù„ÙˆØ¶Ø¹ Ù…Ø³ØªÙ‚Ø± â€“ ÙƒÙ…Ù„ Ø¨Ø­Ø°Ø±</span>";

  document.getElementById("top5").innerHTML=
    "â¬†ï¸ Ø£ÙØ¶Ù„ 5: " +
    scores.slice(0,5).map(x=>
      `<span>${x[0]} <span class='score'>(${x[1]})</span></span>`
    ).join("");

  document.getElementById("reason").innerText=
    "Ø§Ù„ØªØ±ØªÙŠØ¨ Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰: Ø§Ù„ØªÙƒØ±Ø§Ø± Ã— Ø§Ù„ØªØ±Ù†Ø¯ Ã— Ø§Ù„ØºÙŠØ§Ø¨ Ã— Ø§Ù„ØªØ«Ø¨ÙŠØª";

  let btns="";
  all.forEach(i=>{
    btns+=`
    <div class="btn ${data.hot[i]?'hot':''}"
      onclick="add('${i}')"
      ondblclick="toggleHot('${i}')">
      ${i}
    </div>`;
  });
  document.getElementById("buttons").innerHTML=btns;
}

function resetAll(){
  if(confirm("Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")){
    data={selected:[],hot:{}};
    save(); render();
  }
}

render();
</script>
</body>
</html>
