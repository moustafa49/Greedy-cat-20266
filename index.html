<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Greedy Cat MAX ğŸ˜º</title>

<style>
body{
  background:#111;
  color:#fff;
  font-family:Tahoma;
  direction:rtl;
  text-align:center;
}
.card{
  background:#1c1c1c;
  margin:10px;
  padding:12px;
  border-radius:14px;
}
.items,.modes{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:8px;
}
.btn{
  padding:10px;
  border-radius:10px;
  background:#2a2a2a;
  cursor:pointer;
  font-size:22px;
}
.btn.hot{border:2px solid orange}
.btn.active{background:#ff9800;color:#000}
.bar{
  display:flex;
  gap:6px;
  overflow-x:auto;
  padding:6px;
}
.bar span{
  background:#333;
  padding:6px;
  border-radius:8px;
  cursor:pointer;
}
.small{font-size:14px;color:#aaa}
.percent span{margin:4px;display:inline-block}
</style>
</head>

<body>

<h2>ğŸ˜º Greedy Cat MAX</h2>

<div class="card">
  <b>ÙˆØ¶Ø¹ Ø§Ù„ØªÙˆÙ‚Ø¹</b>
  <div class="modes">
    <div class="btn" onclick="setMode('3+1')">3+1</div>
    <div class="btn" onclick="setMode('3+2')">3+2</div>
    <div class="btn" onclick="setMode('3+3')">3+3</div>
    <div class="btn" onclick="setMode('reserve')">Ø§Ø­ØªÙŠØ§Ø·ÙŠ 5</div>
    <div class="btn" onclick="setMode('repeat')">ğŸ” ØªÙƒØ±Ø§Ø±</div>
  </div>
</div>

<div class="card">
  <b>Ø§Ù„Ø£ØµÙ†Ø§Ù</b>
  <div class="items" id="items"></div>
  <div class="small">Ø¶ØºØ· = ØªØ³Ø¬ÙŠÙ„ | Ø¶ØºØ· Ù…Ø·ÙˆÙ„ = HOT ğŸ”¥</div>
</div>

<div class="card">
  <b>Ø¢Ø®Ø± 20 Ø¯ÙˆØ±</b>
  <div class="bar" id="history"></div>
</div>

<div class="card">
  <b>Ø§Ù„ØºØ§ÙŠØ¨ â³</b>
  <div id="missing"></div>
</div>

<div class="card">
  <b>ğŸ”® Ø§Ù„ØªÙˆÙ‚Ø¹ (%)</b>
  <div class="percent" id="prediction"></div>
</div>

<button class="btn" onclick="resetAll()">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>

<script>
const veg = ["ğŸŒ¶ï¸","ğŸ…","ğŸŒ½","ğŸ¥•"];
const meat = ["ğŸ”","ğŸŸ","ğŸ„","ğŸ¦"];
const all = [...veg,...meat];

const weight = {
  "ğŸŒ¶ï¸":5,"ğŸ…":5,"ğŸŒ½":5,"ğŸ¥•":5,
  "ğŸ”":45,"ğŸŸ":25,"ğŸ„":15,"ğŸ¦":10
};

let history=[];
let hot={};
let mode="3+1";

const itemsDiv=document.getElementById("items");

all.forEach(i=>{
  const d=document.createElement("div");
  d.className="btn";
  d.innerText=i;
  d.onclick=()=>add(i);
  d.oncontextmenu=e=>{
    e.preventDefault();
    hot[i]=!hot[i];
    d.classList.toggle("hot",hot[i]);
    calc();
  };
  itemsDiv.appendChild(d);
});

function setMode(m){
  mode=m;
  document.querySelectorAll('.modes .btn').forEach(b=>b.classList.remove('active'));
  event.target.classList.add('active');
  calc();
}

function add(i){
  history.unshift(i);
  if(history.length>100)history.pop();
  render();
  calc();
}

function render(){
  const h=document.getElementById("history");
  h.innerHTML="";
  history.slice(0,20).forEach((i,idx)=>{
    const s=document.createElement("span");
    s.innerText=(idx+1)+"-"+i;
    s.onclick=()=>{
      history.splice(idx,1);
      render();calc();
    };
    h.appendChild(s);
  });

  const miss={};
  all.forEach(a=>{
    const last=history.indexOf(a);
    miss[a]=last===-1?history.length:last;
  });
  document.getElementById("missing").innerHTML=
    Object.entries(miss)
    .sort((a,b)=>b[1]-a[1])
    .map(e=>`${e[0]} ØºØ§ÙŠØ¨ ${e[1]} Ø¯ÙˆØ±`).join("<br>");
}

function calc(){
  const score={};
  all.forEach(a=>score[a]=0);

  history.forEach((i,idx)=>{
    score[i]+=1+(idx<5?2:0);
  });

  Object.keys(hot).forEach(i=>{
    if(hot[i])score[i]+=3;
  });

  all.forEach(i=>{
    score[i]*=weight[i]/10;
  });

  let pick=[];
  if(mode==="repeat"){
    pick=Object.entries(score)
      .sort((a,b)=>b[1]-a[1])
      .slice(0,3);
  }else{
    let v=[],m=[];
    veg.forEach(i=>v.push([i,score[i]]));
    meat.forEach(i=>m.push([i,score[i]]));
    v.sort((a,b)=>b[1]-a[1]);
    m.sort((a,b)=>b[1]-a[1]);

    if(mode==="3+1") pick=[...v.slice(0,3),...m.slice(0,1)];
    if(mode==="3+2") pick=[...v.slice(0,3),...m.slice(0,2)];
    if(mode==="3+3") pick=[...v.slice(0,3),...m.slice(0,3)];
    if(mode==="reserve") pick=[...m.slice(0,4),...v.slice(0,2)];
  }

  const total=pick.reduce((s,a)=>s+a[1],0)||1;
  document.getElementById("prediction").innerHTML=
    pick.map(p=>`${p[0]} ${(p[1]/total*100).toFixed(1)}%`).join(" ");
}

function resetAll(){
  history=[];hot={};
  document.querySelectorAll('.btn').forEach(b=>b.classList.remove('hot'));
  render();calc();
}
</script>

</body>
</html>
